Data in uadia.csv
Scala program for spark:

---------------------------------
package com.sparkTutorial.sparkSql.aadhaar

import org.apache.log4j.{Level, Logger}
import org.apache.spark.sql.SparkSession

object AaadharAnalysis {


  def main(args: Array[String]) {

    Logger.getLogger("org").setLevel(Level.ERROR)
    val session = SparkSession.builder().appName("AaadharAnalysis").master("local[1]").getOrCreate()

    val aadharData = session.read
      .option("header", "true")
      .option("inferSchema", value = true)
      .csv("in/myData/UIDAI-ENR-DETAIL-20180107.csv")

   //Count the number of Identities generated in each state
   aadharData.groupBy("State")
      .count()
      .orderBy("State")
      .show()
/*+------------------+-----+
|               State|count|
+--------------------+-----+
|Andaman and Nicob...|   27|
|      Andhra Pradesh| 8308|
|   Arunachal Pradesh| 1529|
|               Assam| 3327|
|               Bihar|30564|
|          Chandigarh|   87|
|        Chhattisgarh|  450|
|Dadra and Nagar H...|   20|
|       Daman and Diu|   19|
|               Delhi| 3550|
|                 Goa|  687|
|             Gujarat| 3453|
|             Haryana| 1104|
|    Himachal Pradesh|  475|
|   Jammu and Kashmir| 2329|
|           Jharkhand| 4664|
|           Karnataka| 3336|
|              Kerala| 9093|
|         Lakshadweep|    6|
|      Madhya Pradesh|10575|
+--------------------+-----+
only showing top 20 rows   
 */     
      
      
      
  }
}
---------------------
//Count the number of Identities generated in each state Genderwise

aadharData.groupBy("State","Gender")
      .count()
      .orderBy("State","Gender")
      .show()
+--------------------+------+-----+
|               State|Gender|count|
+--------------------+------+-----+
|Andaman and Nicob...|     F|   13|
|Andaman and Nicob...|     M|   14|
|      Andhra Pradesh|     F| 1373|
|      Andhra Pradesh|     M| 6935|
|   Arunachal Pradesh|     F|  738|
|   Arunachal Pradesh|     M|  791|
|               Assam|     F|  562|
|               Assam|     M| 2765|
|               Bihar|     F| 8838|
|               Bihar|     M|21726|
|          Chandigarh|     F|   23|
|          Chandigarh|     M|   64|
|        Chhattisgarh|     F|  296|
|        Chhattisgarh|     M|  154|
|Dadra and Nagar H...|     F|    2|
|Dadra and Nagar H...|     M|   18|
|       Daman and Diu|     F|    8|
|       Daman and Diu|     M|   11|
|               Delhi|     F|  238|
|               Delhi|     M| 3312|
+--------------------+------+-----+
    
 //Count the number of Identities generated by each Enrollment Agency 

 aadharData.groupBy("Enrolment Agency")
      .count()
      .orderBy("Enrolment Agency")
      .show()
+--------------------+-----+
|    Enrolment Agency|count|
+--------------------+-----+
|77 Infosystems Pv...|   25|
|A I Soc for Elect...|   43|
|A-Onerealtors Pvt...| 1052|
|            ADC Aboi|   23|
|          ADC BOLENG|   29|
|        ADC Bhandari|    2|
|         ADC Chozuba|   22|
|      ADC Medziphema|    9|
|      ADC Naginimora|   16|
|         ADC Niuland|    1|
|          ADC Pungro|   47|
|         ADC RUMGONG|    6|
|           ADC Tamlu|    4|
|           ADC Tizit|   23|
|            ADC Tobu|   18|
|        ADC Tseminyu|    4|
|      ADC ZIRO SADAR|   14|
|ADDITIONAL DEPUTY...|   60|
|      AISECT Limited| 6717|
|AKSH OPTIFIBRE LI...|   58|
+--------------------+-----+

//Top 20 Enrollment Agency with max Identities generator

aadharData.groupBy("Enrolment Agency")
      .count()
      .withColumnRenamed("count", "Cnt")
      .orderBy(org.apache.spark.sql.functions.col("Cnt").desc)
      .show()
 +--------------------+-----+
|    Enrolment Agency|  Cnt|
+--------------------+-----+
|             CSC SPV|34175|
|             Akshaya| 8501|
|  Directorate of ESD| 7499|
|Apnatech Consulta...| 7144|
|      AISECT Limited| 6717|
|  Mahaonline Limited| 6361|
|IPS e Services Pv...| 5455|
|Twinstar Industri...| 4997|
|Electronic Servic...| 4723|
| United Telecoms Ltd| 4443|
|Squaria Global In...| 4366|
|      SARADA SYSTEMS| 3571|
|COMTECHINFO SOLUT...| 3516|
|Indotech Engineer...| 3440|
|SREI INFRASTRUCTU...| 3381|
|Youth Infosolutio...| 3270|
|Sarvalabh Global ...| 3004|
|M/s TAVASYA VENTU...| 2936|
|M/s Highway Const...| 2734|
|        Computer LAB| 2490|
+--------------------+-----+

//Top 20 districts(their state as well) with maximum identities generated for both Male and Female 
aadharData.groupBy("District","State")
      .count()
      .withColumnRenamed("count", "Cnt")
      .orderBy(org.apache.spark.sql.functions.col("Cnt").desc)
      .select("District","State","Cnt")
      .withColumnRenamed("State", "Of State")
      .show()

+-----------------+-------------+----+
|         District|     Of State| Cnt|
+-----------------+-------------+----+
|           Ganjam|       Odisha|2138|
|          Bhojpur|        Bihar|1897|
|       Barddhaman|  West Bengal|1890|
|            Siwan|        Bihar|1796|
|         Azamgarh|Uttar Pradesh|1774|
|      Muzaffarpur|        Bihar|1771|
|       Samastipur|        Bihar|1758|
|   East Champaran|        Bihar|1743|
|         Vaishali|        Bihar|1709|
|        Allahabad|Uttar Pradesh|1686|
|North 24 Parganas|  West Bengal|1649|
|           Budaun|Uttar Pradesh|1564|
|       Malappuram|       Kerala|1496|
|          Lucknow|Uttar Pradesh|1418|
|            Patna|        Bihar|1395|
|South 24 Parganas|  West Bengal|1377|
|     Kanpur Nagar|Uttar Pradesh|1363|
|             Agra|Uttar Pradesh|1305|
|      Bulandshahr|Uttar Pradesh|1273|
|            Saran|        Bihar|1261|
+-----------------+-------------+----+

// Top District with max average Age of Residents

aadharData.groupBy("District","State")
      .agg("Age" -> "avg")
      .withColumnRenamed("avg(Age)", "Avg Age")
      .withColumn("AvAge", format_number(org.apache.spark.sql.functions.col("Avg Age"),4))
      .select("District","State","AvAge")
      .withColumnRenamed("State", "Of State")
      .orderBy(org.apache.spark.sql.functions.col("Avg Age").desc)
      .show()
+--------------------+-----------------+-------+
|            District|         Of State|  AvAge|
+--------------------+-----------------+-------+
|     Lahul and Spiti| Himachal Pradesh|56.0000|
|        Kamrup Metro|            Assam|37.3452|
|     West Garo Hills|        Meghalaya|37.0917|
|     East Garo Hills|        Meghalaya|33.9200|
|            Junagadh|          Gujarat|33.7692|
|           Porbandar|          Gujarat|33.5667|
|             Ri Bhoi|        Meghalaya|33.5082|
|South West Khasi ...|        Meghalaya|33.5000|
|  West Jaintia Hills|        Meghalaya|33.1039|
|                 Diu|    Daman and Diu|33.0000|
|             Kolkata|      West Bengal|32.9719|
|           Jalandhar|           Punjab|32.7766|
|             Jashpur|     Chhattisgarh|31.8000|
|            Srinagar|Jammu and Kashmir|31.7931|
|               Udupi|        Karnataka|31.7833|
|          Kapurthala|           Punjab|31.7156|
|           South Goa|              Goa|31.7093|
|                Moga|           Punjab|31.5075|
|              Cachar|            Assam|31.3373|
|            Tinsukia|            Assam|31.2667|
+--------------------+-----------------+-------+

//Get the top enrolment agency having heighest rejection ratio

aadharData.withColumn("EnRej", when(col("Enrolment Rejected") > 0, 1).otherwise(0))
         .groupBy("Enrolment Agency")
         .agg("EnRej" -> "sum", "EnRej" -> "count")
         .withColumn("RejectionRatio",col("sum(EnRej)")*100/col("count(EnRej)"))
         .orderBy(col("RejectionRatio").desc)
         .show()

+--------------------+----------+------------+-----------------+
|    Enrolment Agency|sum(EnRej)|count(EnRej)|   RejectionRatio|
+--------------------+----------+------------+-----------------+
|     CO REBO PERGING|         5|           5|            100.0|
|Rural Environment...|         1|           1|            100.0|
|Vedavaag Systems ...|         1|           1|            100.0|
|           GrapeSoft|         1|           1|            100.0|
|Sri Ramraja Sarka...|         1|           1|            100.0|
|     WCD Govt. of MP|         5|           5|            100.0|
|E-Seva Society Co...|         2|           2|            100.0|
|E-Seva Society Su...|        13|          13|            100.0|
|     DIT Lakshadweep|         4|           4|            100.0|
|NPS Technologies ...|         2|           2|            100.0|
|The Chief Postmas...|         2|           2|            100.0|
|VIRGO SOFTECH LIM...|         1|           1|            100.0|
| UT of Daman and Diu|        22|          22|            100.0|
|MACRO INFOTECH PV...|         1|           1|            100.0|
|E-Seva Society Ju...|        12|          13| 92.3076923076923|
|Jilla E-Seva Soci...|        34|          37|91.89189189189189|
|E-Seva Society Ja...|         8|           9|88.88888888888889|
|Jilla E-seva Sada...|        24|          27|88.88888888888889|
|Make India Smart ...|        71|          81|87.65432098765432|
|Jilla E-Seva Soci...|        21|          24|             87.5|
+--------------------+----------+------------+-----------------+

